REPLACE
<input type="text" data-type="quantity" data-id="{{ index }}" class="quantity" value="{{ line_items[index].quantity }}">
<span class="stock" data-index="{{ index }}"></span>
</div>
WITH
<input type="text" class="quantity" data-type="quantity"
       name="product[grid][{{ sub_option.id }}][quantity]"
       value="{{ form.grid[sub_option.id].quantity | default: 0 }}">
<span class="stock" id="stock_{{ sub_option.id }}"></span>
</div>
END


REPLACE_OR_IGNORE
<td>
  <input type="text" data-type="quantity" data-id="{{ index }}" class="quantity" value="{{ line_items[index].quantity }}">
  <span class="stock" data-index="{{ index }}"></span>
</td>
WITH
<td>
  <input type="text" class="quantity" data-type="quantity"
         name="product[grid][{{ sub_x.id }}][{{ sub_y.id }}][quantity]"
         value="{{ form.grid[sub_x.id][sub_y.id].quantity | default: 0 }}">

  <span class="stock" id="stock_{{ sub_x.id }}_{{ sub_y.id }}"></span>
</td>
END

REPLACE
{% if product.quantity_limits_message %}
    <div class='minimum-order-quantity-help'>
        {{ product.quantity_limits_message }}
    </div>
{% endif %}
WITH
{% if product.minimum_order_quantity > 0 or product.maximum_order_quantity > 0 %}
  <div class='minimum-order-quantity-help'>
    {% include 'quantity_limits_message', product: product %}
  </div>
{% endif %}
END
